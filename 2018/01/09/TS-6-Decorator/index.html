
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Devlog">
    <title>[TS] 6. Decorator - Devlog</title>
    <meta name="author" content="Jbee">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/feed.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jbee","sameAs":["https://github.com/","http://stackoverflow.com/users","https://twitter.com/","https://facebook.com/","https://plus.google.com/","https://www.linkedin.com/profile/","mailto"]},"articleBody":"\n[TS] 6. Decorators이번 포스팅에서는 현재 JavaScript에서도 ts39/proposal stage-2에 올라와있는 Decorator에 대해 알아보겠습니다.\nTable of contents\nSetup\nIntro\nDecorator to method\nDecorator to class\nDecorator with parameter\n\nSetup자바스크립트 babel환경에서 데코레이터를 테스트해보기 위해서는 babel 플러그인이 추가적으로 필요합니다.1$ npm install babel-core babel-plugin-transform-decorators-legacy --save-dev\nbabel-core를 기본으로 하며, babel-plugin을 추가적으로 설치해줍니다..babelrc1234&#123;  //...  \"plugins\": [\"transform-decorators-legacy\"]&#125;\n해당 프로젝트의 babel설정을 담고 있는 .babelrc파일에 설치한 플러그인을 추가해줍니다. 보다 구체적인 해당 개발환경은 여기를 참고해주세요.\nTyeScript에서는 tsconfig.json의 compilerOption을 다음과 같이 변경해줍니다.tsconfig.json123456&#123;    \"compilerOptions\": &#123;        \"target\": \"ES5\",        \"experimentalDecorators\": true    &#125;&#125;\n\nIntroTypeScript(JavaScript)에서 @이라는 character로 사용하는 문법을 Decorator(데코레이터)라고 합니다. 자바를 경험해보신 분이라면 Annotation인가? 라고 생각하기 쉬운데요, 조금 다릅니다. 데코레이터는 함수 라고 할 수 있습니다. 데코레이터는 말 그대로 코드 조각을 장식해주는 역할을 하며 타입스크립트에서는 그 기능을 함수로 구현할 수 있습니다.\nDecorator는 클래스 선언, 메서드, 접근 제어자, 속성 또는 매개 변수에 첨부 할 수 있는 특별한 종류의 선언입니다. 데코레이터는 @expression 형식을 사용하는데, expression은 데코레이팅 된 선언에 대한 정보와 함께 존재하며 이는 런타임에 호출됩니다.\n참조(reference)데코레이터는 @decorator과 같이 사용할 수 있으며 @[name]의 형식일 때 name에 해당하는 이름의 함수를 참조하게 됩니다.\n실행 시점(execute time)이렇게 데코레이터로 정의된 함수는 데코레이터가 적용된 메소드가 실행되거나 클래스가 new라는 키워드를 통해 인스턴스화 될 때가 아닌 런타임 때 실행됩니다. 즉, 매번 실행되지 않습니다.\n그럼 데코레이터가 메소드에 적용되는 경우, 클래스에 적용되는 경우, 프로퍼티에 적용되는 경우 이렇게 세 가지로 나누어 코드를 살펴보겠습니다.\n\nDecorator to Method\n메소드에 적용되는 경우\n\n우선 데코레이터로 사용할 chaining이라는 함수를 정의해줍니다.decorator.js12345function chaining(target: any, key: string, descriptor: PropertyDescriptor): any &#123;  console.log(target); // &#123;bark: f, constructor: f&#125;  console.log(key); // bark  console.log(descriptor); // &#123;value: f, writable: true, enumerable: true, configurable: true&#125;&#125;\n위 함수는 추후 메소드에 @chaining 형식으로 사용될 함수입니다. @과 함께 함수가 호출되는 경우 받게 되는 파라미터는 다음과 같습니다.\n\n\ntarget : 속성을 정의하고자 하는 객체\nname : 속성의 이름\ndescriptor : 새로 정의하고자 하는 속성에 대한 설명\n\n\n이는 Object.defineProperty()를 통해 이를 정의하고 있기 때문입니다.\ntarget은 해당 메소드가 속해있는 클래스 프로토타입을 가리키게 되며 Pet의 프로토타입에는 constructor와 bark메소드가 있는 것을 확인할 수 있습니다. name은 데코레이터가 적용된 메소드의 이름이 됩니다. descriptor는 defineProperty에서 정의할 수 있는 각각의 속성값들이 됩니다.\nObject의 defineProperty에 해당하는 보다 자세한 내용은 여기에서 살펴보실 수 있습니다. 그럼 각각을 활용해서 chaining 기능을 구현해보겠습니다.\n123456789// Decorator to methodfunction chaining(target: any, key: string, descriptor: PropertyDescriptor): any &#123;  const fn: Function = descriptor.value;  descriptor.value = function(...args: any[]) &#123;    fn.apply(target, args);    return target;  &#125;&#125;\ndescriptor의 value가 데코레이터가 적용된 함수, 즉 실행 대상이라고 할 수 있습니다. descriptor.value를 재정의(override)하기 전에 fn이라는 변수로 caching해둔 다음, 호출한 후의 일을 정의하기 위해 위와 같이 재정의 해줍니다. 재정의 하기 전 caching 해둔 함수를 호출하기 위해서 apply 함수를 사용했습니다. 어떠한 변수가 얼만큼 전달될지 모르니 rest parameter를 통해 fn을 호출해주는 코드입니다.\n위와 같이 descriptor.value가 재정의 되면 chaining이 적용된 메소드는 재정의된대로 호출되게 됩니다.\n\napply 함수에 대한 내용은 여기를 참고해주세요.\n\n12345class Pet &#123;  @chaining  bark() &#123;  &#125;&#125;\n위와 같이 적용해보겠습니다.1const pet = new Pet();\nPet클래스에서 bark라는 메소드는 Pet.prototype.bark로 됩니다. class syntax 내부에서 위 코드에서는 bark라는 메소드가 Pet의 prototype의 프로퍼티로 추가되기 전에 decorate 함수가 실행되어 본래 bark라는 메소드에서 정의된 것에 추가적인 ‘장식’ 을 더해 prototype에 추가되도록 합니다.\n\n만약 compile target이 ES5보다 낮다면 PropertyDescriptor 값으로 undefined이 전달됩니다.\n\n1pet.bark().bark();\n위 데코레이터의 효과로 return this;를 해주지 않아도 chaining 기능을 사용하여 메소드를 호출할 수 있습니다.\n\nDecorator to Class하지만 데코레이터가 class에 적용되었을 때는 그 signature가 조금 달라집니다. 클래스 데코레이터는 클래스 선언 바로 전에 선언됩니다. 클래스 데코레이터는 클래스 생성자에 적용되며 클래스 정의를 관찰, 수정 또는 대체하는 데 사용할 수 있습니다.\n클래스 데코레이터가 값을 반환하면 클래스 선언을 제공된 생성자 함수로 바꿉니다.\n12345function component(target, name, descriptor) &#123;  console.log(target); // ...  console.log(name); // undefined  console.log(descriptor); //undefined&#125;\n메소드에 데코레이터를 적용하듯이 데코레이터 함수를 선언하면 올바른 선언을 할 수 없습니다. 클래스에 적용되는 데코레이터 함수에 전달되는 인자는 constructor하나입니다. 제대로 된 데코레이터 선언은 다음과 같습니다.12345function classDecorator&lt;T extends &#123;new(...args:any[]):&#123;&#125;&#125;&gt;(constructor:T) &#123;  return class extends constructor &#123;    newProperty = \"new property\";  &#125;&#125;\n클래스에 적용되는 데코레이터 함수 내에서 새로운 생성자 함수를 반환하면 원래 프로토타입을 유지해야 합니다. 런타임에 데코레이터를 적용하는 로직은 이를 수행하지 않기 때문입니다. 위 코드에서는 기존의 프로토타입을 유지하기 위해 적용되는 클래스의 constructor를 extends 합니다.\n123456789@classDecoratorclass Pet &#123;  constructor(name: string) &#123;    this.name = name;  &#125;&#125;const pet = new Pet(\"async\");console.log(pet.newProperty); // new Property\nclassDecorator 데코레이터가 적용된 Pet 클래스의 인스턴스에는 newProperty가 존재하지 않지만 데코레이터 함수에서 해당 클래스의 constructor를 재정의했기 대문에 newProperty에 접근할 수 있습니다.\n\nDecorator with parameter\n파라미터를 받는 데코레이터\n\n데코레이터 함수에 인자를 넘겨줄 수 있습니다. 이 인자는 무엇이든 될 수 있습니다. 예제 코드로 descriptor의 enumerable 속성을 변경하는 데코레이터를 만들어보겠습니다.\n123function enumerableToFalse(target: any, propertyKey: string, descriptor: PropertyDescriptor) &#123;  descriptor.enumerable = false;&#125;;\n이렇게 정의하면 enumerableToFalse이 적용된 메소드의 enumerable 속성은 false가 됩니다. 위 enumerableToFalse 함수를 한 번 감싸서 반환하는 함수를 만들면 다음과 같습니다.\n12345function enumerable(value: boolean) &#123;  return function (target: any, propertyKey: string, descriptor: PropertyDescriptor) &#123;    descriptor.enumerable = value;  &#125;;&#125;\n이제 이 함수를 데코레이터 함수로 사용할 수 있습니다. value에 해당하는 값으로 데코레이터를 적용하는 메소드의 enumerable속성을 제어할 수 있습니다.\n123456class Pet &#123;  @enumerable(false)  bark() &#123;  //...  &#125;&#125;\n위와 같이 false라는 인자를 받는 데코레이터를 정의했습니다. 저 인자에는 함수도 들어갈 수 있으며 데코레이터도 들어갈 수 있습니다.\n마무리target을 ES5로 지정해야 제대로 된 데코레이터를 사용할 수 있어서 아직 한계가 있는 Decorator지만 React에서는 HOC(High-Order-Component)에 많이 사용하고 있는 Decorator 였습니다!\n감사합니다.\n6. Decorator in TypeScript end\nReference\nTypeScript Official Document - Generics\nhttps://github.com/wycats/javascript-decorators\nhttps://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841\nhttps://www.sitepoint.com/javascript-decorators-what-they-are/\nhttps://cabbageapps.com/fell-love-js-decorators/\nhttps://javarouka.github.io/blog/2016/09/30/decorator-exploring/#class-il-gyeongu\nhttps://github.com/jayphelps/core-decorators\n\n","dateCreated":"2018-01-09T09:59:14+09:00","dateModified":"2018-01-09T09:59:37+09:00","datePublished":"2018-01-09T09:59:14+09:00","description":"","headline":"[TS] 6. Decorator","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/"},"publisher":{"@type":"Organization","name":"Jbee","sameAs":["https://github.com/","http://stackoverflow.com/users","https://twitter.com/","https://facebook.com/","https://plus.google.com/","https://www.linkedin.com/profile/","mailto"]},"url":"https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/","keywords":"ts"}</script>
    <meta name="description" content="[TS] 6. Decorators이번 포스팅에서는 현재 JavaScript에서도 ts39/proposal stage-2에 올라와있는 Decorator에 대해 알아보겠습니다. Table of contents Setup Intro Decorator to method Decorator to class Decorator with parameter  Setup자바">
<meta name="keywords" content="ts">
<meta property="og:type" content="blog">
<meta property="og:title" content="[TS] 6. Decorator">
<meta property="og:url" content="https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/index.html">
<meta property="og:site_name" content="Devlog">
<meta property="og:description" content="[TS] 6. Decorators이번 포스팅에서는 현재 JavaScript에서도 ts39/proposal stage-2에 올라와있는 Decorator에 대해 알아보겠습니다. Table of contents Setup Intro Decorator to method Decorator to class Decorator with parameter  Setup자바">
<meta property="og:image" content="https://jaeyeophan.github.io/images/typescript.png">
<meta property="og:updated_time" content="2018-01-09T00:59:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[TS] 6. Decorator">
<meta name="twitter:description" content="[TS] 6. Decorators이번 포스팅에서는 현재 JavaScript에서도 ts39/proposal stage-2에 올라와있는 Decorator에 대해 알아보겠습니다. Table of contents Setup Intro Decorator to method Decorator to class Decorator with parameter  Setup자바">
<meta name="twitter:image" content="https://jaeyeophan.github.io/images/typescript.png">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Devlog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://stackoverflow.com/users" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://plus.google.com/" target="_blank" rel="noopener" title="Google +">
                    
                        <i class="sidebar-button-icon fab fa-google-plus" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google +</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/profile/" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/mailto"
                            title="Mail"
                        >
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            [TS] 6. Decorator
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-01-09T09:59:14+09:00">
	
		    Jan 09, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/TypeScript/">TypeScript</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p><img src="/images/typescript.png" alt=""></p>
<h1 id="TS-6-Decorators"><a href="#TS-6-Decorators" class="headerlink" title="[TS] 6. Decorators"></a>[TS] 6. Decorators</h1><p>이번 포스팅에서는 현재 JavaScript에서도 <a href="https://github.com/tc39/proposal-decorators" target="_blank" rel="external">ts39/proposal stage-2</a>에 올라와있는 <code>Decorator</code>에 대해 알아보겠습니다.</p>
<h3 id="Table-of-contents"><a href="#Table-of-contents" class="headerlink" title="Table of contents"></a>Table of contents</h3><ul>
<li>Setup</li>
<li>Intro</li>
<li>Decorator to method</li>
<li>Decorator to class</li>
<li>Decorator with parameter</li>
</ul>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>자바스크립트 babel환경에서 데코레이터를 테스트해보기 위해서는 babel 플러그인이 추가적으로 필요합니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-core babel-plugin-transform-decorators-legacy --save-dev</div></pre></td></tr></table></figure></p>
<p><code>babel-core</code>를 기본으로 하며, babel-plugin을 추가적으로 설치해줍니다.<br><figure class="highlight"><figcaption><span>.babelrc</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  //...</div><div class="line">  "plugins": ["transform-decorators-legacy"]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>해당 프로젝트의 babel설정을 담고 있는 <code>.babelrc</code>파일에 설치한 플러그인을 추가해줍니다. 보다 구체적인 해당 개발환경은 <a href="https://github.com/JaeYeopHan/esnext_labs" target="_blank" rel="external">여기</a>를 참고해주세요.</p>
<p>TyeScript에서는 <code>tsconfig.json</code>의 <code>compilerOption</code>을 다음과 같이 변경해줍니다.<br><figure class="highlight json"><figcaption><span>tsconfig.json</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"compilerOptions"</span>: &#123;</div><div class="line">        <span class="attr">"target"</span>: <span class="string">"ES5"</span>,</div><div class="line">        <span class="attr">"experimentalDecorators"</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>TypeScript(JavaScript)에서 <code>@</code>이라는 character로 사용하는 문법을 <code>Decorator(데코레이터)</code>라고 합니다. 자바를 경험해보신 분이라면 <code>Annotation</code>인가? 라고 생각하기 쉬운데요, 조금 다릅니다. 데코레이터는 <strong>함수</strong> 라고 할 수 있습니다. 데코레이터는 말 그대로 코드 조각을 장식해주는 역할을 하며 타입스크립트에서는 그 기능을 함수로 구현할 수 있습니다.</p>
<p>Decorator는 클래스 선언, 메서드, 접근 제어자, 속성 또는 매개 변수에 첨부 할 수 있는 특별한 종류의 선언입니다. 데코레이터는 <code>@expression</code> 형식을 사용하는데, expression은 데코레이팅 된 선언에 대한 정보와 함께 존재하며 이는 <strong>런타임에</strong> 호출됩니다.</p>
<h4 id="참조-reference"><a href="#참조-reference" class="headerlink" title="참조(reference)"></a>참조(reference)</h4><p>데코레이터는 <code>@decorator</code>과 같이 사용할 수 있으며 <code>@[name]</code>의 형식일 때 <code>name</code>에 해당하는 이름의 함수를 참조하게 됩니다.</p>
<h4 id="실행-시점-execute-time"><a href="#실행-시점-execute-time" class="headerlink" title="실행 시점(execute time)"></a>실행 시점(execute time)</h4><p>이렇게 데코레이터로 정의된 함수는 데코레이터가 적용된 메소드가 실행되거나 클래스가 <code>new</code>라는 키워드를 통해 인스턴스화 될 때가 아닌 런타임 때 실행됩니다. 즉, 매번 실행되지 않습니다.</p>
<p><em>그럼 데코레이터가 메소드에 적용되는 경우, 클래스에 적용되는 경우, 프로퍼티에 적용되는 경우 이렇게 세 가지로 나누어 코드를 살펴보겠습니다.</em></p>
<p><br></p>
<h2 id="Decorator-to-Method"><a href="#Decorator-to-Method" class="headerlink" title="Decorator to Method"></a>Decorator to Method</h2><blockquote>
<p>메소드에 적용되는 경우</p>
</blockquote>
<p>우선 데코레이터로 사용할 <code>chaining</code>이라는 함수를 정의해줍니다.<br><figure class="highlight ts"><figcaption><span>decorator.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">chaining</span>(<span class="params">target: <span class="built_in">any</span>, key: <span class="built_in">string</span>, descriptor: PropertyDescriptor</span>): <span class="title">any</span> </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(target); <span class="comment">// &#123;bark: f, constructor: f&#125;</span></div><div class="line">  <span class="built_in">console</span>.log(key); <span class="comment">// bark</span></div><div class="line">  <span class="built_in">console</span>.log(descriptor); <span class="comment">// &#123;value: f, writable: true, enumerable: true, configurable: true&#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>위 함수는 추후 메소드에 <code>@chaining</code> 형식으로 사용될 함수입니다. <code>@</code>과 함께 함수가 호출되는 경우 받게 되는 파라미터는 다음과 같습니다.</p>
<blockquote>
<ul>
<li>target : 속성을 정의하고자 하는 객체</li>
<li>name : 속성의 이름</li>
<li>descriptor : 새로 정의하고자 하는 속성에 대한 설명</li>
</ul>
</blockquote>
<p>이는 <code>Object.defineProperty()</code>를 통해 이를 정의하고 있기 때문입니다.</p>
<p><code>target</code>은 해당 메소드가 속해있는 클래스 프로토타입을 가리키게 되며 <code>Pet</code>의 프로토타입에는 <code>constructor</code>와 <code>bark</code>메소드가 있는 것을 확인할 수 있습니다. <code>name</code>은 데코레이터가 적용된 메소드의 이름이 됩니다. <code>descriptor</code>는 <code>defineProperty</code>에서 정의할 수 있는 각각의 속성값들이 됩니다.</p>
<p>Object의 <code>defineProperty</code>에 해당하는 보다 자세한 내용은 <a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="external">여기</a>에서 살펴보실 수 있습니다. 그럼 각각을 활용해서 <code>chaining</code> 기능을 구현해보겠습니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Decorator to method</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">chaining</span>(<span class="params">target: <span class="built_in">any</span>, key: <span class="built_in">string</span>, descriptor: PropertyDescriptor</span>): <span class="title">any</span> </span>&#123;</div><div class="line">  <span class="keyword">const</span> fn: <span class="built_in">Function</span> = descriptor.value;</div><div class="line"></div><div class="line">  descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params">...args: <span class="built_in">any</span>[]</span>) </span>&#123;</div><div class="line">    fn.apply(target, args);</div><div class="line">    <span class="keyword">return</span> target;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>descriptor의 <code>value</code>가 데코레이터가 적용된 함수, 즉 실행 대상이라고 할 수 있습니다. <code>descriptor.value</code>를 재정의(override)하기 전에 <code>fn</code>이라는 변수로 caching해둔 다음, 호출한 후의 일을 정의하기 위해 위와 같이 재정의 해줍니다. 재정의 하기 전 caching 해둔 함수를 호출하기 위해서 <code>apply</code> 함수를 사용했습니다. 어떠한 변수가 얼만큼 전달될지 모르니 rest parameter를 통해 <code>fn</code>을 호출해주는 코드입니다.</p>
<p>위와 같이 <code>descriptor.value</code>가 재정의 되면 <code>chaining</code>이 적용된 메소드는 재정의된대로 호출되게 됩니다.</p>
<blockquote>
<p><code>apply</code> 함수에 대한 내용은 <a href="https://www.google.co.kr/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0ahUKEwj9wKqt1cDYAhUBtpQKHQNvC34QFggmMAA&amp;url=https%3A%2F%2Fdeveloper.mozilla.org%2Fko%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FFunction%2Fapply&amp;usg=AOvVaw2tqAzWzgnT49rXId1wsV11" target="_blank" rel="external">여기</a>를 참고해주세요.</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Pet &#123;</div><div class="line">  <span class="meta">@chaining</span></div><div class="line">  bark() &#123;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>위와 같이 적용해보겠습니다.<br><figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> pet = <span class="keyword">new</span> Pet();</div></pre></td></tr></table></figure></p>
<p><code>Pet</code>클래스에서 <code>bark</code>라는 메소드는 <code>Pet.prototype.bark</code>로 됩니다. class syntax 내부에서 위 코드에서는 <code>bark</code>라는 메소드가 <code>Pet</code>의 prototype의 프로퍼티로 추가되기 전에 <code>decorate</code> 함수가 실행되어 본래 <code>bark</code>라는 메소드에서 정의된 것에 추가적인 <strong>‘장식’</strong> 을 더해 prototype에 추가되도록 합니다.</p>
<blockquote>
<p>만약 compile target이 ES5보다 낮다면 <code>PropertyDescriptor</code> 값으로 <code>undefined</code>이 전달됩니다.</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pet.bark().bark();</div></pre></td></tr></table></figure>
<p>위 데코레이터의 효과로 <code>return this;</code>를 해주지 않아도 chaining 기능을 사용하여 메소드를 호출할 수 있습니다.</p>
<p><br></p>
<h2 id="Decorator-to-Class"><a href="#Decorator-to-Class" class="headerlink" title="Decorator to Class"></a>Decorator to Class</h2><p>하지만 데코레이터가 class에 적용되었을 때는 그 signature가 조금 달라집니다. 클래스 데코레이터는 클래스 선언 바로 전에 선언됩니다. 클래스 데코레이터는 클래스 생성자에 적용되며 클래스 정의를 관찰, 수정 또는 대체하는 데 사용할 수 있습니다.</p>
<p>클래스 데코레이터가 값을 반환하면 클래스 선언을 제공된 생성자 함수로 바꿉니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">component</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(target); <span class="comment">// ...</span></div><div class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// undefined</span></div><div class="line">  <span class="built_in">console</span>.log(descriptor); <span class="comment">//undefined</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>메소드에 데코레이터를 적용하듯이 데코레이터 함수를 선언하면 올바른 선언을 할 수 없습니다. 클래스에 적용되는 데코레이터 함수에 전달되는 인자는 <code>constructor</code>하나입니다. 제대로 된 데코레이터 선언은 다음과 같습니다.<br><figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">classDecorator</span>&lt;<span class="title">T</span> <span class="title">extends</span> </span>&#123;<span class="keyword">new</span>(...args:<span class="built_in">any</span>[]):&#123;&#125;&#125;&gt;(<span class="keyword">constructor</span>:T) &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">class</span> <span class="keyword">extends</span> <span class="keyword">constructor</span> &#123;</div><div class="line">    newProperty = <span class="string">"new property"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>클래스에 적용되는 데코레이터 함수 내에서 새로운 생성자 함수를 반환하면 원래 프로토타입을 유지해야 합니다. 런타임에 데코레이터를 적용하는 로직은 이를 수행하지 않기 때문입니다. 위 코드에서는 기존의 프로토타입을 유지하기 위해 적용되는 클래스의 <code>constructor</code>를 <code>extends</code> 합니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@classDecorator</span></div><div class="line"><span class="keyword">class</span> Pet &#123;</div><div class="line">  <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> pet = <span class="keyword">new</span> Pet(<span class="string">"async"</span>);</div><div class="line"><span class="built_in">console</span>.log(pet.newProperty); <span class="comment">// new Property</span></div></pre></td></tr></table></figure>
<p><code>classDecorator</code> 데코레이터가 적용된 <code>Pet</code> 클래스의 인스턴스에는 <code>newProperty</code>가 존재하지 않지만 데코레이터 함수에서 해당 클래스의 constructor를 재정의했기 대문에 <code>newProperty</code>에 접근할 수 있습니다.</p>
<p><br></p>
<h2 id="Decorator-with-parameter"><a href="#Decorator-with-parameter" class="headerlink" title="Decorator with parameter"></a>Decorator with parameter</h2><blockquote>
<p>파라미터를 받는 데코레이터</p>
</blockquote>
<p>데코레이터 함수에 인자를 넘겨줄 수 있습니다. 이 인자는 무엇이든 될 수 있습니다. 예제 코드로 descriptor의 <code>enumerable</code> 속성을 변경하는 데코레이터를 만들어보겠습니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">enumerableToFalse</span>(<span class="params">target: <span class="built_in">any</span>, propertyKey: <span class="built_in">string</span>, descriptor: PropertyDescriptor</span>) </span>&#123;</div><div class="line">  descriptor.enumerable = <span class="literal">false</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>이렇게 정의하면 <code>enumerableToFalse</code>이 적용된 메소드의 enumerable 속성은 false가 됩니다. 위 <code>enumerableToFalse</code> 함수를 한 번 감싸서 반환하는 함수를 만들면 다음과 같습니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">enumerable</span>(<span class="params">value: <span class="built_in">boolean</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target: <span class="built_in">any</span>, propertyKey: <span class="built_in">string</span>, descriptor: PropertyDescriptor</span>) </span>&#123;</div><div class="line">    descriptor.enumerable = value;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>이제 이 함수를 데코레이터 함수로 사용할 수 있습니다. <code>value</code>에 해당하는 값으로 데코레이터를 적용하는 메소드의 <code>enumerable</code>속성을 제어할 수 있습니다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Pet &#123;</div><div class="line">  <span class="meta">@enumerable</span>(<span class="literal">false</span>)</div><div class="line">  bark() &#123;</div><div class="line">  <span class="comment">//...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>위와 같이 <code>false</code>라는 인자를 받는 데코레이터를 정의했습니다. 저 인자에는 함수도 들어갈 수 있으며 데코레이터도 들어갈 수 있습니다.</p>
<h3 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h3><p>target을 ES5로 지정해야 제대로 된 데코레이터를 사용할 수 있어서 아직 한계가 있는 Decorator지만 React에서는 HOC(High-Order-Component)에 많이 사용하고 있는 Decorator 였습니다!</p>
<p>감사합니다.</p>
<p><em>6. Decorator in TypeScript end</em></p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><a href="https://www.typescriptlang.org/docs/handbook/generics.html" target="_blank" rel="external">TypeScript Official Document - Generics</a></li>
<li><a href="https://github.com/wycats/javascript-decorators" target="_blank" rel="external">https://github.com/wycats/javascript-decorators</a></li>
<li><a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841" target="_blank" rel="external">https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841</a></li>
<li><a href="https://www.sitepoint.com/javascript-decorators-what-they-are/" target="_blank" rel="external">https://www.sitepoint.com/javascript-decorators-what-they-are/</a></li>
<li><a href="https://cabbageapps.com/fell-love-js-decorators/" target="_blank" rel="external">https://cabbageapps.com/fell-love-js-decorators/</a></li>
<li><a href="https://javarouka.github.io/blog/2016/09/30/decorator-exploring/#class-il-gyeongu" target="_blank" rel="external">https://javarouka.github.io/blog/2016/09/30/decorator-exploring/#class-il-gyeongu</a></li>
<li><a href="https://github.com/jayphelps/core-decorators" target="_blank" rel="external">https://github.com/jayphelps/core-decorators</a></li>
</ul>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/ts/">ts</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/02/React-tips-for-beginners/" data-tooltip="[번역] React를 본격적으로 하기 전 알면 좋은 6가지" aria-label="PREVIOUS: [번역] React를 본격적으로 하기 전 알면 좋은 6가지">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/10/TS-7-TypeScript-type-system/" data-tooltip="[TS] 7. TypeScript type system" aria-label="NEXT: [TS] 7. TypeScript type system">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jbee. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/02/React-tips-for-beginners/" data-tooltip="[번역] React를 본격적으로 하기 전 알면 좋은 6가지" aria-label="PREVIOUS: [번역] React를 본격적으로 하기 전 알면 좋은 6가지">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/01/10/TS-7-TypeScript-type-system/" data-tooltip="[TS] 7. TypeScript type system" aria-label="NEXT: [TS] 7. TypeScript type system">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://jaeyeophan.github.io/2018/01/09/TS-6-Decorator/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Jbee</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>


<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Devlog">
    <title>Tag: TDD - Devlog</title>
    <meta name="author" content="Jbee">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/feed.xml">
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="blog posted about front end development">
<meta property="og:type" content="blog">
<meta property="og:title" content="Devlog">
<meta property="og:url" content="https://jaeyeophan.github.io/tags/TDD/index.html">
<meta property="og:site_name" content="Devlog">
<meta property="og:description" content="blog posted about front end development">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Devlog">
<meta name="twitter:description" content="blog posted about front end development">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Devlog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="http://stackoverflow.com/users" target="_blank" rel="noopener" title="Stack Overflow">
                    
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://twitter.com/" target="_blank" rel="noopener" title="Twitter">
                    
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://plus.google.com/" target="_blank" rel="noopener" title="Google +">
                    
                        <i class="sidebar-button-icon fab fa-google-plus" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google +</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/profile/" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/mailto"
                            title="Mail"
                        >
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2017/04/23/BDD-3-chai-http/">
                            [TDD] 3. Chai-http 사용하여 REST API Test하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2017-04-23T16:07:57+09:00">
	
		    Apr 23, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Tool/">Tool</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><img src="/images/tool_chai.png" alt=""></p>
<h1 id="TDD-3-Chai-http-사용하여-REST-API-Test하기"><a href="#TDD-3-Chai-http-사용하여-REST-API-Test하기" class="headerlink" title="[TDD] 3. Chai-http 사용하여 REST API Test하기"></a>[TDD] 3. Chai-http 사용하여 REST API Test하기</h1><p><a href="https://jaeyeophan.github.io/2017/04/23/BDD-1-mocha/">&gt;Mocha - Getting started&gt;</a><br><br><a href="https://jaeyeophan.github.io/2017/04/23/BDD-2-chai/">&gt;Chai - Getting started&gt;</a></p>
<p>이번 포스팅에서는 <code>chai-http</code>라는 module을 사용해서 REST API를 테스트하는 코드를 작성해보겠습니다.</p>
<p>테스트에 집중하기 위해 요청을 받을 서버는 <code>json-server</code>라는 모듈을 사용하여 구축하겠습니다. <code>json</code>형태로 데이터를 생성하고 요청을 받을 수 있는 임시 서버입니다. 데이터베이스를 따로 구축하지 않아도 <code>CRUD</code>와 같은 기본적인 API를 제공해주는 모듈입니다. 포스팅에서 다루는 내용보다 더 자세한 내용은 해당 <a href="https://github.com/typicode/json-server" target="_blank" rel="external">링크</a>를 참조하시면 되겠습니다.</p>
<h2 id="테스트-환경-구축하기"><a href="#테스트-환경-구축하기" class="headerlink" title="테스트 환경 구축하기"></a>테스트 환경 구축하기</h2><p>우선 <code>chai-http</code>를 설치합니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn add chai-http</div></pre></td></tr></table></figure></p>
<p>그리고 서버로 사용할 <code>json-server</code>를 설치합니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn global add json-server</div></pre></td></tr></table></figure></p>
<p>그런 다음 <code>src</code> 디렉토리(작업하고자 하는 디렉토리)로 이동하여 다음 명령어를 실행해줍니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ json-server --watch db.json</div></pre></td></tr></table></figure></p>
<p>위 명령어를 실행하게 되면 <code>db.json</code> 파일을 생성하게 되고 해당 <code>.json</code>파일에 기본적인 데이터가 들어가있습니다. <code>json-server</code>는 기본적으로 <code>3000</code>번 포트를 사용합니다. <a href="http://localhost:3000/" target="_blank" rel="external">localhost:3000</a>에 접속해보면 어떠한 데이터가 들어가있는지를 간단한 웹 페이지를 통해서도 확인하실 수 있습니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">\&#123;^_^&#125;/ hi!</div><div class="line"></div><div class="line">Loading db.json</div><div class="line">Done</div></pre></td></tr></table></figure></p>
<p>console에는 귀여운 이모티콘이 환영을 해주네요 :)</p>
<p>보다 customized한 서버를 사용하시고 싶은 경우에는 다음과 같은 <code>.js</code>파일을 만들어 사용하실 수 있습니다.<br><figure class="highlight javascript"><figcaption><span>server.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> jsonServer = <span class="built_in">require</span>(<span class="string">'json-server'</span>);</div><div class="line"><span class="keyword">const</span> server = jsonServer.create();</div><div class="line"><span class="keyword">const</span> router = jsonServer.router(<span class="string">'db.json'</span>);</div><div class="line"><span class="keyword">const</span> middlewares = jsonServer.defaults();</div><div class="line"></div><div class="line">server.use(middlewares);</div><div class="line">server.use(router);</div><div class="line">server.listen(<span class="number">3000</span>, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'JSON Server is running'</span>)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>위 파일은 <code>node server.js</code> 명령어로 실행하실 수 있습니다 :) 이번 포스팅에서는 default로 생성되는 임시 서버를 사용하겠습니다.</p>
<h2 id="test-파일-작성"><a href="#test-파일-작성" class="headerlink" title=".test 파일 작성"></a>.test 파일 작성</h2><p>이제 테스트 코드를 작성할 <code>.test</code>파일을 만들어 보겠습니다.<br><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> chai = <span class="built_in">require</span>(<span class="string">'chai'</span>);</div><div class="line"><span class="keyword">const</span> chaiHttp = <span class="built_in">require</span>(<span class="string">'chai-http'</span>);</div><div class="line"><span class="keyword">const</span> expect = chai.expect;</div><div class="line">chai.use(chaiHttp);</div><div class="line"></div><div class="line"><span class="keyword">const</span> url = <span class="string">'http://localhost:3000'</span>;</div></pre></td></tr></table></figure></p>
<p>이전에 설치한 <code>chai</code>와 테스트 환경을 구축할 때 설치한 <code>chai-http</code>를 불러옵니다. 그리고 <code>chai</code>가 <code>chai-http</code>를 <code>use</code>합니다. 이전 포스팅에서 소개해드렸던 <code>expect</code>를 사용하기 위해 준비합니다. 마지막으로 요청을 보낼 서버의 api에서 반복될 url을 상수로 할당해줬습니다.</p>
<h2 id="Request-TEST"><a href="#Request-TEST" class="headerlink" title="Request TEST"></a>Request TEST</h2><p>본격적인 테스트 코드를 작성할 시간입니다. 우선 server에 요청이 제대로 가는지 확인해보겠습니다.<br><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Request test'</span>, () =&gt; &#123;</div><div class="line">    it(<span class="string">'request to server'</span>, done =&gt; &#123;</div><div class="line">        chai.request(url)</div><div class="line">            .get(<span class="string">'/'</span>)</div><div class="line">            .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">                expect(err).to.be.null;</div><div class="line">                expect(res).to.have.status(<span class="number">200</span>);</div><div class="line">                done();</div><div class="line">            &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>위 코드는 <code>http://localhost:3000/</code>에 대한 <code>GET</code> 요청이 제대로 동작하는지 테스트하는 코드입니다.<br>해당 <code>url</code>로 <code>request</code>를 보내고 <code>get</code> 방식으로 그 요청을 보냅니다. 요청에 대한 응답을 <code>.end()</code>메소드로 받을 수 있습니다. 이 <code>end()</code> 메소드에는 요청에 대한 응답으로 <code>err</code>와 <code>res</code>를 파라미터로 받는 콜백 함수를 넘겨줍니다.<br>콜백 함수에서는 에러(<code>err</code>)는 <code>null</code>값이어야 하고, http status code는 <code>200</code>이어야 한다는 내용을 담고 있습니다. 모든 조건이 만족되면 <code>done()</code> 함수가 호출되면서 test가 pass하게 됩니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm <span class="built_in">test</span></div></pre></td></tr></table></figure></p>
<p>위 명령어로 test를 실행해보겠습니다. 방금 전 <code>json-server</code>를 running한 터미널 창이 아닌 다른 터미널 창에서 실행하셔야 합니다. 요청을 받으러면 서버가 running 중이어야 하니까요 :)<br><figure class="highlight bash"><figcaption><span>test terminal</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">REST <span class="built_in">test</span></div><div class="line">  ✓ request to server</div><div class="line"></div><div class="line">1 passing (13ms)</div></pre></td></tr></table></figure></p>
<p>해당 테스트가 잘 pass한 것을 확인하실 수 있습니다.<br><figure class="highlight bash"><figcaption><span>json-server terminal</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET / 200 2.318 ms - -</div></pre></td></tr></table></figure></p>
<p>그리고 아까 <code>json-server --watch db.json</code> 명령어를 실행한 console에서는 GET요청에 대한 로그를 남깁니다.</p>
<h2 id="CRUD-TEST"><a href="#CRUD-TEST" class="headerlink" title="CRUD TEST"></a>CRUD TEST</h2><h3 id="Data-Modeling"><a href="#Data-Modeling" class="headerlink" title="Data Modeling"></a>Data Modeling</h3><p>테스트를 위해 <code>db.json</code>에 간단한 데이터를 넣어보겠습니다. 다음과 비슷한 형식으로 바꿔줍니다.<br><figure class="highlight json"><figcaption><span>db.json</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"users"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"id"</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"Jbee"</span>,</div><div class="line">      <span class="attr">"age"</span>: <span class="number">25</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"id"</span>: <span class="number">2</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"foo"</span>,</div><div class="line">      <span class="attr">"age"</span>: <span class="number">20</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"id"</span>: <span class="number">3</span>,</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"bar"</span>,</div><div class="line">      <span class="attr">"age"</span>: <span class="number">30</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><code>users</code>라는 배열을 지정해줬습니다. 배열의 요소에는 <code>name</code>과 <code>age</code>를 갖고 있는 <code>json</code>형식의 데이터를 넣어줬습니다. 저장을 하면 <code>--watch</code>옵션을 붙여 실행했기 때문에 변경된 데이터 사항이 자동으로 반영됩니다. <code>localhost:3000</code>의 웹 페이지도 새로고침을 해보면 새로운 데이터가 들어가있는 것을 확인하실 수 있습니다. 이 데이터에는 <code>/users</code>라는 api로 접근이 가능합니다.</p>
<h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p><code>db.json</code>파일에 추가한 <code>users</code>데이터를 가져와 봅시다.<br><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'GET'</span>, () =&gt; &#123;</div><div class="line">  it(<span class="string">'fetch all users'</span>, done =&gt; &#123;</div><div class="line">    chai.request(url)</div><div class="line">        .get(<span class="string">'/users'</span>)</div><div class="line">        .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">            expect(err).to.be.not.ok;</div><div class="line">            expect(res).to.have.status(<span class="number">200</span>);</div><div class="line">            expect(res.body).to.be.an(<span class="string">'array'</span>);</div><div class="line">            done();</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>이전의 코드와 매우 유사합니다. <code>res.body</code>에 대한 값을 확인하는 코드가 추가되었습니다. array 형식의 데이터라면 test를 pass시키도록 테스트 코드를 작성했습니다. test가 잘 통과하네요 :)<br>특정 <code>user</code>에 대한 값만 가져오려면 어떻게 해야 할까요?<br><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">it(<span class="string">'fetch one user'</span>, done =&gt; &#123;</div><div class="line">  chai.request(url)</div><div class="line">      .get(<span class="string">'/users'</span>)</div><div class="line">      .query(&#123;<span class="attr">id</span>: <span class="number">1</span>&#125;)</div><div class="line">      .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">          expect(err).to.be.null;</div><div class="line">          expect(res).to.have.status(<span class="number">200</span>);</div><div class="line">          expect(res.body[<span class="number">0</span>]).to.deep.equal(</div><div class="line">              &#123;</div><div class="line">                  <span class="attr">id</span>: <span class="number">1</span>,</div><div class="line">                  <span class="attr">name</span>: <span class="string">"Jbee"</span>,</div><div class="line">                  <span class="attr">age</span>: <span class="number">25</span></div><div class="line">              &#125;</div><div class="line">          );</div><div class="line">          done();</div><div class="line">      &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>위 예제 코드를 describe 콜백 함수 안에 추가해줍니다. 와 같이 <code>.query()</code>에 해당하는 조건을 넘겨줄 수 있습니다. 응답으로 오는 데이터가 명시한 값과 일치하는지를 테스트 코드로 작성해줬습니다.</p>
<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'POST'</span>, () =&gt; &#123;</div><div class="line">  it(<span class="string">'add user'</span>, done =&gt; &#123;</div><div class="line">    chai.request(url)</div><div class="line">        .post(<span class="string">'/users'</span>)</div><div class="line">        .send(&#123;<span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">'react'</span>, <span class="attr">age</span>: <span class="number">3</span>&#125;)</div><div class="line">        .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">            expect(err).to.be.not.ok;</div><div class="line">            expect(res).to.have.status(<span class="number">201</span>);</div><div class="line">            user = res.body;</div><div class="line">            done();</div><div class="line">        &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>post()</code>메소드와 <code>send()</code> 메소드를 통해 테스트를 진행할 수 있습니다.</p>
<h3 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h3><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'PATCH'</span>, () =&gt; &#123;</div><div class="line">  it(<span class="string">'update user'</span>, done =&gt; &#123;</div><div class="line">    chai.request(url)</div><div class="line">        .patch(<span class="string">'/users/2'</span>)</div><div class="line">        .send(&#123;<span class="attr">name</span>: <span class="string">'angular'</span>, <span class="attr">age</span>: <span class="number">1</span>&#125;)</div><div class="line">        .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">            expect(err).to.be.not.ok;</div><div class="line">            expect(res).to.have.status(<span class="number">200</span>);</div><div class="line">            done();</div><div class="line">        &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>patch()</code>메소드와 <code>send()</code> 메소드를 통해 테스트를 진행할 수 있습니다.</p>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><figure class="highlight javascript"><figcaption><span>rest.test.js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'DELETE'</span>, () =&gt; &#123;</div><div class="line">  it(<span class="string">'delete user'</span>, done =&gt; &#123;</div><div class="line">    chai.request(url)</div><div class="line">        .delete(<span class="string">'/users/4'</span>)</div><div class="line">        .end(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</div><div class="line">            expect(err).to.be.not.ok;</div><div class="line">            expect(res).to.have.status(<span class="number">200</span>);</div><div class="line">            done();</div><div class="line">        &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>delete()</code>메소드를 통해 테스트를 진행할 수 있습니다.</p>
<p>예제로 사용된 코드는 <a href="https://github.com/JaeYeopHan/javascript_test_tutorial" target="_blank" rel="external">Github Respository</a>에서 확인하실 수 있습니다.</p>
<p><em>[TDD] 3. end</em></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2017/04/23/BDD-3-chai-http/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
            <a href="/2017/04/23/BDD-3-chai-http/">
                <div class="postShorten-thumbnailimg">
                    <img alt="" src="undefined"/>
                </div>
            </a>
            
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2017/04/23/BDD-2-chai/">
                            [TDD] 2. Chai - Getting started
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2017-04-23T16:07:45+09:00">
	
		    Apr 23, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Tool/">Tool</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><img src="/images/tool_chai.png" alt=""></p>
<h1 id="TDD-2-Chai-Getting-started"><a href="#TDD-2-Chai-Getting-started" class="headerlink" title="[TDD] 2. Chai - Getting started"></a>[TDD] 2. Chai - Getting started</h1><p><a href="https://jaeyeophan.github.io/2017/04/23/BDD-1-mocha/">&gt;Mocha - Getting started&gt;</a></p>
<p>이전 포스팅에서 <code>Mocha</code>를 사용한 테스트를 진행해봤습니다. 이전 포스팅의 예제 코드에 Assertion Library인 <code>Chai</code>를 추가해보겠습니다.</p>
<p><code>Chai</code>는 세 가지 style의 <code>Assertion</code>을 제공합니다.</p>
<ul>
<li>assert<br>기본적으로 node에서 제공하는 <code>Assert</code>라이브러리와 유사합니다.<br></li>
<li>expect<br><code>BDD</code> 스타일로 제공되는 인터페이스 중 하나로 공식 문서에서는 <code>natural longuage</code>처럼 <code>chaining</code>을 제공하여 코드를 작성할 수 있게 해준다고 합니다. 잠시 후 예제 코드로 살펴보겠습니다.<br></li>
<li>should<br><code>BDD</code> 스타일로 제공되는 인터페이스 중 나머지 하나로 <code>expect</code> 인터페이스와 마찬가지로 <code>chainging</code>을 통한 API를 제공합니다.<br></li>
</ul>
<p>라이브러리에 대한 보다 구체적인 내용은 공식 문서를 참조하시면 되겠습니다. <a href="http://chaijs.com/guide/styles/" target="_blank" rel="external">&gt;Chai Documents&gt;</a></p>
<h2 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h2><p>우선, <code>Chai</code>를 설치해줍니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yarn global add chai</div></pre></td></tr></table></figure>
<p>이전에 작성했던 <code>/test/operator.test.js</code> 코드에서 <code>Chai</code>를 불러옵니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> chai = <span class="built_in">require</span>(<span class="string">'chai'</span>);</div><div class="line"><span class="keyword">const</span> expect = chai.expect;</div><div class="line"><span class="keyword">const</span> should = chai.should();</div></pre></td></tr></table></figure>
<p><code>expect</code>와 <code>should</code>가 불러오는 방식이 약간 다릅니다. <code>expect</code> 인터페이스는 assertion을 제공하는 시작점으로 함수를 제공합니다. <code>should</code> 인터페이스는 <code>Object.prototype</code>을 확장하여 단일 Getter를 제공하고 그것을 시작점으로 제공합니다.</p>
<p><code>expect</code> 인터페이스를 통해 지저분했던 <code>if</code> 구문을 제거해봅시다!</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'sum 함수 테스트'</span>, () =&gt; &#123;</div><div class="line">    it (<span class="string">'10과 20를 넘기면 30이 나와야 한다'</span>, done =&gt; &#123;</div><div class="line">        <span class="keyword">let</span> result = sum(<span class="number">10</span>, <span class="number">20</span>);</div><div class="line">        expect(result).to.equal(<span class="number">30</span>);</div><div class="line">        done();</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>첫번째로 등장한 api, <code>equal</code>입니다! <code>equal()</code>메소드에는 파라미터르 기대값이 들어가게 됩니다. 테스트 하고자 하는 함수의 반환 값이 기대값과 다르게 되면 그에 해당하는 error message가 나타납니다. 30을 40으로 바꾸고 실행해보겠습니다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">sum 함수 테스트</div><div class="line">    1) 10과 20를 넘기면 30이 나와야 한다</div><div class="line"></div><div class="line">  0 passing (6ms)</div><div class="line">  1 failing</div><div class="line"></div><div class="line">  1) sum 함수 테스트 10과 20를 넘기면 30이 나와야 한다:</div><div class="line"></div><div class="line">      AssertionError: expected 30 to equal 40</div><div class="line">      + expected - actual</div><div class="line"></div><div class="line">      -30</div><div class="line">      +40</div><div class="line"></div><div class="line">      at Context.done (<span class="built_in">test</span>/operator.test.js:37:27)</div></pre></td></tr></table></figure>
<p>정말 친절한 <code>log</code>가 출력되는 것을 확인할 수 있습니다. describe에 기술했던 section 이름이 제일 먼저 출력되고, 테스트를 실행한 단위 테스트의 이름이 출력됩니다. 그리고 통과한 단위 테스트와 실패한 단위 테스트에 대한 정보가 나타납니다. 기대값과 실제 반환값과의 차이를 보여주며 어느 부분에서 에러가 발생했는지까지 출력됩니다 :)</p>
<h2 id="Expect-API"><a href="#Expect-API" class="headerlink" title="Expect API"></a>Expect API</h2><p><a href="http://chaijs.com/api/bdd/" target="_blank" rel="external">BDD style, Expect API</a></p>
<h3 id="ok"><a href="#ok" class="headerlink" title=".ok"></a>.ok</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">expect(<span class="literal">false</span>).to.not.be.ok;</div><div class="line">expect(<span class="literal">undefined</span>).to.not.be.ok;</div><div class="line">expect(<span class="literal">null</span>).to.not.be.ok;</div></pre></td></tr></table></figure>
<p>넘겨받는 값이 <code>false</code>인지 <code>undefined</code>인지 <code>null</code>인지 한 번에 판단할 수 있는 API입니다. 위 예제 코드에서는 일단 테스트가 통과하는 상황을 만들기 위해 <code>not</code>을 붙였는데요, 실제 테스트 코드에서는 <code>not</code>을 제거하여 사용하면 값을 한 번에 판단할 수 있는 API가 됩니다. <code>boolean</code>에 대해서는 <code>.true</code>, <code>.falase</code>가 별도로 존재합니다. 그리고 배열이 <code>empty</code>인지를 판단하는 <code>.empty</code>도 별도로 존재합니다.</p>
<h3 id="deep"><a href="#deep" class="headerlink" title=".deep"></a>.deep</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">expect(foo).to.deep.equal(&#123; <span class="attr">bar</span>: <span class="string">'baz'</span> &#125;);</div><div class="line">expect(&#123; <span class="attr">foo</span>: &#123; <span class="attr">bar</span>: &#123; <span class="attr">baz</span>: <span class="string">'quux'</span> &#125; &#125; &#125;)</div><div class="line">  .to.have.deep.property(<span class="string">'foo.bar.baz'</span>, <span class="string">'quux'</span>);</div></pre></td></tr></table></figure>
<p>객체를 <code>equal</code>로 비교를 하기 위해서는 추가적으로 <code>deep</code> flag가 필요합니다.</p>
<h3 id="include-vs-have"><a href="#include-vs-have" class="headerlink" title=".include vs .have"></a>.include vs .have</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//.include vs .have</span></div><div class="line">expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).to.include(<span class="number">2</span>);</div><div class="line"><span class="comment">// expect([1,2,3]).to.have(2); // error!</span></div><div class="line">expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]).to.have.property(<span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;;</div><div class="line">expect(obj).to.include.property(<span class="string">'foo'</span>);</div><div class="line">expect(obj).to.have.property(<span class="string">'foo'</span>);</div><div class="line"></div><div class="line">expect(<span class="string">'foobar'</span>).to.include.string(<span class="string">'bar'</span>);</div><div class="line">expect(<span class="string">'foobar'</span>).to.have.string(<span class="string">'bar'</span>);</div></pre></td></tr></table></figure>
<p>(사실 두 API의 차이점을 잘 모르겠다.)</p>
<h3 id="사용하기"><a href="#사용하기" class="headerlink" title="사용하기"></a>사용하기</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deepCss = &#123; <span class="string">'.link'</span>: &#123; <span class="string">'[target]'</span>: <span class="number">42</span> &#125;&#125;;</div><div class="line">expect(deepCss).to.have.deep.property(<span class="string">'\\.link.\\[target\\]'</span>, <span class="number">42</span>);</div></pre></td></tr></table></figure>
<p><code>.</code>이나 <code>[</code>,<code>]</code>을 사용하기 위해서는 <code>\\</code>를 사용하여 표시할 수 있습니다.</p>
<p>제공되는 API 종류가 정말 많아서, 왠지 있을 것 같은 API는 <a href="http://chaijs.com/api/bdd/" target="_blank" rel="external">공식 문서</a>에서 찾아보면서 테스트 코드를 작성하면 되겠습니다.</p>
<p>예제로 사용된 코드는 <a href="https://github.com/JaeYeopHan/javascript_test_tutorial" target="_blank" rel="external">Github Respository</a>에서 확인하실 수 있습니다.</p>
<p><a href="https://jaeyeophan.github.io/2017/04/23/BDD-3-chai-http/">&gt;Chai-http를 사용하여 REST API test하기&gt;</a></p>
<p><em>[TDD] 2. end</em></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2017/04/23/BDD-2-chai/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
            <a href="/2017/04/23/BDD-2-chai/">
                <div class="postShorten-thumbnailimg">
                    <img alt="" src="undefined"/>
                </div>
            </a>
            
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2017/04/23/BDD-1-mocha/">
                            [TDD] 1. Mocha - Getting started
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2017-04-23T16:07:34+09:00">
	
		    Apr 23, 2017
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Tool/">Tool</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><img src="/images/tool_mocha.png" alt=""></p>
<h1 id="TDD-1-Mocha-Getting-started"><a href="#TDD-1-Mocha-Getting-started" class="headerlink" title="[TDD] 1. Mocha - Getting started"></a>[TDD] 1. Mocha - Getting started</h1><p><code>Mocha</code>란 러너를 포함하고 있는 테스트 프레임워크로 사용자 수가 가장 많은 테스크 프레임워크입니다. <code>Mocha</code>는 자체적으로 assertion을 지원하지 않기 때문에 다른 <code>Assertion</code>라이브러리와 함께 사용해야 합니다. 기본적으로 node에서 제공하는 <code>assert</code>라이브러리가 존재하며 요즘에는 주로 <code>chai</code>라는 라이브러리와 함께 사용한다고 합니다. 라이브러리에 대한 내용은 공식 문서를 참조하시면 되겠습니다.<br><a href="http://mochajs.org/" target="_blank" rel="external">&gt;Mocha Documents</a></p>
<p>Mocha는 기본적으로 BDD 기반의 프레임워크입니다. 하지만 BDD와 TDD 두 종류의 인터페이스를 모두 제공하고 있습니다. 이번 포스팅에서는 BDD 기반의 예제를 살펴봅니다.<br><a href="http://joshldavis.com/2013/05/27/difference-between-tdd-and-bdd/" target="_blank" rel="external">TDD vs BDD</a></p>
<h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><ol>
<li><code>mocha</code>를 global로 설치해줍니다. <em>(cf <a href="http://jaeyeophan.github.io/2017/04/21/YARN-New-Package-Manger/">YARN, 새로운 Package Manager</a>)</em><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ yarn global add mocha</div><div class="line"><span class="comment">#success Installed "mocha@3.2.0" with binaries:</span></div><div class="line"><span class="comment">#      - mocha</span></div><div class="line"><span class="comment">#      - _mocha</span></div><div class="line"><span class="comment">#✨  Done in 4.23s.</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>저는 3.2.0 version의 <code>mocha</code>를 설치했습니다.</p>
<ol>
<li>보다 간편한 테스트 run을 위해 <code>package.json</code>에 scripts 추가합니다.<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[...]</div><div class="line">"scripts": &#123;</div><div class="line">  "test": "mocha $(find ./ -name '*./test/**/*.test.js') --recursive -w"</div><div class="line">&#125;,</div><div class="line">[...]</div></pre></td></tr></table></figure>
</li>
</ol>
<p><code>test</code>라는 명령어로 <code>mocha</code>를 실행하며 <code>test</code>디렉토리에 있고 <code>.test.js</code>파일을 찾아 <code>mocha</code>를 실행시킵니다. 그리고 추가적으로 <code>-w</code>옵션을 통해 파일이 변경될 때마다 자동으로 테스트를 수행할 수 있게 합니다.</p>
<ol>
<li><code>/src/operator.js</code> 파일을 생성하고 다음 코드를 작성합니다.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">exports.sum = <span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> a + b;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>정말 간단하게, 두 수를 파라미터로 받아 합을 반환하는 <code>sum</code> 함수를 테스트해보겠습니다.</p>
<ol>
<li><code>/test/operator.test.js</code> 파일을 생성하고 다음 코드를 작성합니다.<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> operator = <span class="built_in">require</span>(<span class="string">'../src/operator'</span>);</div><div class="line"><span class="keyword">const</span> sum = operator.sum;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>우선 <code>/src/operator.js</code> 파일을 <code>import</code>합니다.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'operator.js Test'</span>, () =&gt; &#123;</div><div class="line">    describe(<span class="string">'sum 함수 테스트'</span>, () =&gt; &#123;</div><div class="line">        it (<span class="string">'10과 20를 넘기면 30이 나와야 한다.'</span>, done =&gt; &#123;</div><div class="line">            <span class="keyword">let</span> result = sum(<span class="number">10</span>, <span class="number">20</span>);</div><div class="line">            <span class="keyword">if</span> (result === <span class="number">30</span>) &#123;</div><div class="line">                done();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'결과 값이 30이 아니다.'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>드디어 테스트 코드를 작성했습니다. <code>describe</code>에서는 테스트의 <code>이름</code>을 지정합니다. 위 예제 코드처럼 중첩하여 사용할 수 있으며 테스트를 구분하는 <code>section</code>이라고 표현할 수 있겠습니다. 그리고 실행해야하는 부분(단위 테스트 단위)을 콜백으로 넘겨줍니다. <code>it</code> 구문에는 단위 테스트 이름을 작성하고 실제 실행되는 코드를 콜백(<code>done</code>)으로 넘겨줍니다. 그런 다음, <code>package.json</code>에 작성했던 <code>npm test</code> 명령어를 통해 test를 실행해줍니다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ npm test</div><div class="line">  sum 함수 테스트</div><div class="line">    ✓ 10과 20를 넘기면 30이 나와야 한다.</div><div class="line"></div><div class="line">  1 passing (2ms)</div></pre></td></tr></table></figure></p>
<p>이렇게 나왔으면 테스트가 통과한 것입니다. <code>done()</code> 메소드가 실행되면 테스트가 통과하도록 테스트 코드를 작성할 수 있습니다. <code>result === 40</code>처럼 옳지 않은 값을 넣어주면, <code>throw Error()</code>가 실행되면서 테스트가 실패했다는 메세지가 나타납니다.</p>
<h3 id="Mocha의-hook"><a href="#Mocha의-hook" class="headerlink" title="Mocha의 hook"></a>Mocha의 hook</h3><p><code>Mocha</code>에서는 추가적으로 네 가지의 함수를 제공합니다. 각각은 테스트 코드가 실행되기 전과 후에 실행되는 함수입니다.</p>
<ul>
<li>before<br>: 테스트 코드가 실행되기 전에 한 번 실행된다.</li>
<li>beforeEach<br>: (테스트가 여러 개일 경우) 각각의 테스트 코드가 실행되기 전마다 실행된다.</li>
<li>afterEach<br>: (테스트가 여러 개일 경우) 각각의 테스트 코드가 실행된 후마다 실행된다.</li>
<li>after<br>: 모든 테스트 코드가 실행된 후 한 번 실행된다.</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'operator.js Test'</span>, () =&gt; &#123;</div><div class="line">    describe(<span class="string">'sum 함수 테스트'</span>, () =&gt; &#123;</div><div class="line">        before(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"before"</span>);</div><div class="line">        &#125;);</div><div class="line">        beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">           <span class="built_in">console</span>.log(<span class="string">"beforeEach"</span>);</div><div class="line">        &#125;);</div><div class="line">        it (<span class="string">'10과 20를 넘기면 30이 나와야 한다.'</span>, (done) =&gt; &#123;</div><div class="line">            <span class="keyword">let</span> result = sum(<span class="number">10</span>, <span class="number">20</span>);</div><div class="line">            <span class="keyword">if</span> (result === <span class="number">30</span>) &#123;</div><div class="line">                done();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'결과 값이 30이 아니다.'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        after(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"after"</span>);</div><div class="line">        &#125;);</div><div class="line">        afterEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"afterEach"</span>);</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>각각 상황에 맞는 <code>console.log()</code>를 찍어줬습니다. <code>npm test</code> 명령어를 실행해보겠습니다.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ npm <span class="built_in">test</span></div><div class="line">  operator.js Test</div><div class="line">    sum 함수 테스트</div><div class="line">before</div><div class="line">beforeEach</div><div class="line">      ✓ 10과 20를 넘기면 30이 나와야 한다.</div><div class="line">afterEach</div><div class="line">after</div><div class="line"></div><div class="line">  1 passing (3ms)</div></pre></td></tr></table></figure></p>
<p>각각의 함수들이 위치하는 라인은 상관이 없습니다. 가독성이 좋기 위해 의미상으로 적절한 위치에 코드를 작성했습니다. 정말 간단하게 <code>Mocha</code>를 사용해봤습니다. <code>if</code>문을 통한 테스트 코드 작성이 너무 지저분했는데요, 이제 <code>Mocha</code>와 함께 <code>Chai</code>를 사용해보겠습니다!</p>
<p><a href="https://jaeyeophan.github.io/2017/04/23/BDD-2-chai/">&gt;&gt;Chai 테스트 프레임워크 &gt;&gt;</a></p>
<p>예제로 사용된 코드는 <a href="https://github.com/JaeYeopHan/javascript_test_tutorial" target="_blank" rel="external">Github Respository</a>에서 확인하실 수 있습니다.</p>
<p><em>[TDD] 1. end</em></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2017/04/23/BDD-1-mocha/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
            <a href="/2017/04/23/BDD-1-mocha/">
                <div class="postShorten-thumbnailimg">
                    <img alt="" src="undefined"/>
                </div>
            </a>
            
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jbee. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Jbee</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->



    </body>
</html>
